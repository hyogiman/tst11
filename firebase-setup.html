<!DOCTYPE html>
<html>
<head>
    <title>Firebase 초기화</title>
</head>
<body>
    <h1>Firebase 데이터 초기화</h1>
    <button onclick="initializeDatabase()">데이터베이스 초기화</button>
    <div id="status"></div>

    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    
    <!-- 여기에 Firebase 설정 스크립트 내용 복사 -->
    <script>
// Firebase 초기 데이터 설정 스크립트
// 이 스크립트를 별도 HTML 파일로 만들어서 실행하세요

// 1. Firebase Config (본인의 실제 정보)
const firebaseConfig = {
    apiKey: "AIzaSyAxw0xYVu-rvRxOCLInMkqIJeuRIt35qU4",
    authDomain: "ncc2-c4bfa.firebaseapp.com",
    projectId: "ncc2-c4bfa",
    storageBucket: "ncc2-c4bfa.firebasestorage.app",
    messagingSenderId: "386144165760",
    appId: "1:386144165760:web:09492a8eed4a1b710deb65"
};

// Firebase 초기화
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// 2. 로그인 코드 생성 함수
async function setupLoginCodes() {
    const loginCodes = [
        // 탐정 코드들
        { code: 'A1B2', role: 'detective' },
        { code: 'D3T4', role: 'detective' },
        { code: 'G7H8', role: 'detective' },
        { code: 'J9K0', role: 'detective' },
        
        // 범인 코드들
        { code: 'C3D4', role: 'criminal' },
        { code: 'F5G6', role: 'criminal' },
        { code: 'I8J9', role: 'criminal' },
        
        // 상인 코드들
        { code: 'E5F6', role: 'merchant' },
        { code: 'H7I8', role: 'merchant' },
        { code: 'K1L2', role: 'merchant' },
        { code: 'M3N4', role: 'merchant' },
        { code: 'P5Q6', role: 'merchant' },
        { code: 'R7S8', role: 'merchant' },
        { code: 'T9U0', role: 'merchant' },
        { code: 'V1W2', role: 'merchant' },
    ];

    const batch = db.batch();
    
    loginCodes.forEach(item => {
        const docRef = db.collection('loginCodes').doc(item.code);
        batch.set(docRef, {
            role: item.role,
            used: false,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });
    });

    try {
        await batch.commit();
        console.log('로그인 코드 설정 완료!');
    } catch (error) {
        console.error('로그인 코드 설정 실패:', error);
    }
}

// 3. 게임 설정 초기화
async function setupGameSettings() {
    try {
        await db.collection('gameSettings').doc('config').set({
            maxKills: 3,
            gameActive: true,
            killTimer: 180, // 3분 (초)
            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
            lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
        });
        console.log('게임 설정 완료!');
    } catch (error) {
        console.error('게임 설정 실패:', error);
    }
}

// 4. 시크릿 코드 풀 설정
async function setupSecretCodes() {
    const secretCodes = {
        detective: ['DT01', 'DT02', 'DT03', 'DT04', 'DT05', 'DT06', 'DT07', 'DT08'],
        criminal: ['CR01', 'CR02', 'CR03', 'CR04', 'CR05', 'CR06', 'CR07', 'CR08'],
        merchant: ['MC01', 'MC02', 'MC03', 'MC04', 'MC05', 'MC06', 'MC07', 'MC08', 'MC09', 'MC10']
    };

    try {
        await db.collection('gameSettings').doc('secretCodes').set({
            ...secretCodes,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        console.log('시크릿 코드 풀 설정 완료!');
    } catch (error) {
        console.error('시크릿 코드 풀 설정 실패:', error);
    }
}

// 5. 실행 함수
async function initializeDatabase() {
    console.log('데이터베이스 초기화 시작...');
    
    await setupLoginCodes();
    await setupGameSettings();
    await setupSecretCodes();
    
    console.log('모든 초기화 완료!');
}

// 실행
initializeDatabase();

// 6. 데이터 확인 함수들
async function checkLoginCodes() {
    const snapshot = await db.collection('loginCodes').get();
    console.log('=== 로그인 코드 목록 ===');
    snapshot.forEach(doc => {
        console.log(doc.id, '=>', doc.data());
    });
}

async function checkPlayers() {
    const snapshot = await db.collection('players').get();
    console.log('=== 플레이어 목록 ===');
    if (snapshot.empty) {
        console.log('등록된 플레이어가 없습니다.');
    } else {
        snapshot.forEach(doc => {
            console.log(doc.id, '=>', doc.data());
        });
    }
}

// 데이터 확인 (필요 시 실행)
// checkLoginCodes();
// checkPlayers();
    </script>
</body>
</html>
